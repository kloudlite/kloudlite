---
global:
  accountName: kloudlite-dev
  providerName: sample 
  providerNamespace: s1
  providerSecretName: provider-sample

  clusterName: sample
---

label: Create Cloud Provider Secret
query: |+
  mutation Infra_createProviderSecret($secret: CloudProviderSecretIn!) {
    infra_createProviderSecret(secret: $secret) {
      data
      id
    }
  }
variables:
  secret:
    cloudProviderName: aws
    metadata:
      name: "{{.providerSecretName}}"
    stringData:
      k1: v1
      k2: v2

---

label: Update Cloud Provider Secret
query: |+
  mutation Infra_updateProviderSecret($secret: CloudProviderSecretIn!) {
    infra_updateProviderSecret(secret: $secret) {
      data
      id
    }
  }
variables:
  secret:
    metadata:
      name: "{{.providerSecretName}}"
    stringData:
      k1: v1
      k2: v2
      k3: v3
---

label: List Provider Secrets
query: |+
  query Infra_listProviderSecrets($search: SearchProviderSecret) {
    infra_listProviderSecrets(search: $search) {
      edges {
        node {
          accountName
          metadata {
            name
            namespace
          }
        }
      }
    }
  }
variables:
  search:
    text: 
      matchType: 'regex'
      regex: '.*aws.*'
    cloudProviderName:
      # matchType: 'exact' # regex array
      # exact: "aws"
      # matchType: 'array' # regex array
      # array: ["aws"]
      matchType: 'regex'
      regex: 'aws$'

---

label: Get Provider Secret
query: |+
  query Infra_getProviderSecret($name: String!) {
    infra_getProviderSecret(name: $name) {
      accountName
      metadata {
        name
      } 
      cloudProviderName
    }
  }
variables:
  name: "{{.providerSecretName}}"
---

label: Delete Provider Secret
query: |+
  mutation Infra_deleteProviderSecret($secretName: String!) {
    infra_deleteProviderSecret(secretName: $secretName)
  }
variables:
  secretName: "{{.providerSecretName}}"
---
