---
global:
  accountId: "acc-imgtxz4logeg-isxm4uqlpzzwctr"
  projectId: "proj-ci1xmobjyia7cc00optpbeavpnmn"
  projectName: "example-plaxonic"
---
label: create github pipeline
query: |
  mutation Ci_createPipeline($in: GitPipelineIn!) {
    ci_createPipeline(in: $in)
  }
variables:
  in:
    name: sample-pipeline
    accountId: acc-wo4rgoszo9dmsa1na-yhbsvh75gj
    projectId: proj-s1ok37ubokp62aszwu0jdoq4uorr
    appId: app-pg5r5t4bqez31rvwyjgys8z0k55y
    gitProvider: github
    gitRepoUrl: https://github.com/nxtcoder17/sample
    repoName: sample
    gitBranch: master
    build:
      baseImage: docker
      cmd: |+
        docker build -t ${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG} .
    run:
      baseImage: docker
      cmd: ""
    artifactRef:
      dockerImageName: sample
      dockerImageTag: latest

---
label: Create Gitlab Pipeline
query: |
  mutation Ci_createPipeline($in: GitPipelineIn!) {
    ci_createPipeline(in: $in)
  }
variables:
  in:
    name: sample-pipeline
    projectName: "{{projectName}}"
    accountId: "{{accountId}}"
    projectId: "{{projectName}}"
    # appId: app-pg5r5t4bqez31rvwyjgys8z0k55y
    appId: "sample"
    gitProvider: gitlab
    # gitRepoUrl: https://gitlab.com/nxtcoder17/sample
    gitRepoUrl: https://gitlab.com/plaxoniclabs/projects/plaxonic.com/website
    repoName: plaxonic-website
    gitBranch: latest
    docker-file: ./Dockerfile
    docker-context-dir: ./
    # build:
    #   baseImage: docker
    #   cmd: |+
    #     docker build -t ${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG} .
    # run:
    #   baseImage: docker
    #   cmd: ""
    artifactRef:
      dockerImageName: harbor.dev.madhouselabs.io/kloudlite/plaxonic-website
      dockerImageTag: latest
---
label: Create Gitlab Pipeline with buildCmd
query: |
  mutation Ci_createPipeline($in: GitPipelineIn!) {
    ci_createPipeline(in: $in)
  }
variables:
  in:
    name: sample-pipeliney
    projectName: sample-x
    containerName: main
    accountId: acc-wo4rgoszo9dmsa1na-yhbsvh75gj
    projectId: proj-ll5s-miviimb0icwvznki9jqzkyi
    appId: app-pg5r5t4bqez31rvwyjgys8z0k55y
    gitProvider: gitlab
    gitRepoUrl: https://gitlab.com/nxtcoder17/sample
    repoName: sample
    gitBranch: master
    build:
      baseImage: node:alpine
      cmd: npm i
      outputDir: app,package.json
    run:
      baseImage: node:alpine
      cmd: npm start
    artifactRef:
      dockerImageName: sample
      dockerImageTag: latest
---
label: Create Gitlab Pipeline with buildCmd (error)
query: |
  mutation Ci_createDockerPipeLine($in: GitDockerPipelineIn!) {
    ci_createDockerPipeLine(in: $in)
  }
variables:
  in:
    repoName: backend_np-cart
    projectId: proj-0f1hjg-c0q0ndi9-damtr5f78vrq
    accountId: acc-gqjm9v7geosp9mnkdt-kdiewwjc4
    projectName: sample-proje-24785
    containerName: main
    gitBranch: main
    name: pipeline_sample-app-27390-main
    gitRepoUrl: https://github.com/abdheshnayak/backend_np-cart.git
    gitProvider: github
    artifactRef:
      dockerImageName: 9fb-4d0b-bb67-e9dc16834193
      dockerImageTag: latest
    appId: sample-app-27390
    dockerFile: Dockerfile
    contextDir: ./
    buildArgs: ''
---
label: list pipelines
query: |
  query Ci_getPipelines($projectId: ID!) {
    ci_getPipelines(projectId: $projectId) {
      id
      name
      gitProvider
      gitRepoUrl
      gitBranch
      build {
        baseImage
        cmd
      }
      run {
        baseImage
        cmd
      }
      metadata
    }
  }
variables:
  projectId: proj-ll5s-miviimb0icwvznki9jqzkyi
---

label: get pipeline
query: |
  query Ci_getPipelines($pipelineId: ID!) {
    ci_getPipeline(pipelineId: $pipelineId) {
      id
      repoName
      name
      gitProvider
      gitRepoUrl
      build {
        baseImage
        cmd
      }
      gitBranch
      run {
        baseImage
        cmd
      }
      metadata
    }
  }
variables:
  pipelineId: pip-xlf2psoeq4ft215kuyhija7vlezj
---
label: Delete pipeline
query: |
  mutation Ci_deletePipeline($pipelineId: ID!) {
    ci_deletePipeline(pipelineId: $pipelineId)
  }
variables:
  pipelineId: pip-sdmpguqbhbcdsbbsbzklc9ogfsff
