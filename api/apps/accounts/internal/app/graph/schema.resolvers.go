package graph

// This file will be automatically regenerated based on the schema, any resolver implementations
// will be copied through when generating and any unknown code will be moved to the end.
// Code generated by github.com/99designs/gqlgen version v0.17.28

import (
	"context"

	"kloudlite.io/apps/accounts/internal/app/graph/generated"
	"kloudlite.io/apps/accounts/internal/app/graph/model"
	"kloudlite.io/apps/accounts/internal/domain"
	"kloudlite.io/apps/accounts/internal/entities"
	iamT "kloudlite.io/apps/iam/types"
	"kloudlite.io/pkg/repos"
)

// AccountsCreateAccount is the resolver for the accounts_createAccount field.
func (r *mutationResolver) AccountsCreateAccount(ctx context.Context, account entities.Account) (*entities.Account, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.CreateAccount(uc, account)
}

// AccountsUpdateAccount is the resolver for the accounts_updateAccount field.
func (r *mutationResolver) AccountsUpdateAccount(ctx context.Context, account entities.Account) (*entities.Account, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.UpdateAccount(uc, account)
}

// AccountsDeactivateAccount is the resolver for the accounts_deactivateAccount field.
func (r *mutationResolver) AccountsDeactivateAccount(ctx context.Context, accountName string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.DeactivateAccount(uc, accountName)
}

// AccountsActivateAccount is the resolver for the accounts_activateAccount field.
func (r *mutationResolver) AccountsActivateAccount(ctx context.Context, accountName string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.ActivateAccount(uc, accountName)
}

// AccountsDeleteAccount is the resolver for the accounts_deleteAccount field.
func (r *mutationResolver) AccountsDeleteAccount(ctx context.Context, accountName string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.DeactivateAccount(uc, accountName)
}

// AccountsInviteMember is the resolver for the accounts_inviteMember field.
func (r *mutationResolver) AccountsInviteMember(ctx context.Context, accountName string, invitation entities.Invitation) (*entities.Invitation, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.InviteMember(uc, accountName, invitation)
}

// AccountsResendInviteMail is the resolver for the accounts_resendInviteMail field.
func (r *mutationResolver) AccountsResendInviteMail(ctx context.Context, accountName string, invitationID string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.ResendInviteEmail(uc, accountName, repos.ID(invitationID))
}

// AccountsDeleteInvitation is the resolver for the accounts_deleteInvitation field.
func (r *mutationResolver) AccountsDeleteInvitation(ctx context.Context, accountName string, invitationID string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.DeleteInvitation(uc, accountName, repos.ID(invitationID))
}

// AccountsAcceptInvitation is the resolver for the accounts_acceptInvitation field.
func (r *mutationResolver) AccountsAcceptInvitation(ctx context.Context, accountName string, inviteToken string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.AcceptInvitation(uc, accountName, inviteToken)
}

// AccountsRejectInvitation is the resolver for the accounts_rejectInvitation field.
func (r *mutationResolver) AccountsRejectInvitation(ctx context.Context, accountName string, inviteToken string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}

	return r.domain.RejectInvitation(uc, accountName, inviteToken)
}

// AccountsRemoveAccountMembership is the resolver for the accounts_removeAccountMembership field.
func (r *mutationResolver) AccountsRemoveAccountMembership(ctx context.Context, accountName string, memberID repos.ID) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.RemoveAccountMembership(uc, accountName, memberID)
}

// AccountsUpdateAccountMembership is the resolver for the accounts_updateAccountMembership field.
func (r *mutationResolver) AccountsUpdateAccountMembership(ctx context.Context, accountName string, memberID repos.ID, role string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}
	return r.domain.UpdateAccountMembership(uc, accountName, memberID, iamT.Role(role))
}

// AccountsListAccounts is the resolver for the accounts_listAccounts field.
func (r *queryResolver) AccountsListAccounts(ctx context.Context) ([]*entities.Account, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	a, err := r.domain.ListAccounts(uc)
	if err != nil {
		return nil, err
	}
	if a == nil {
		return []*entities.Account{}, nil
	}
	return a, nil
}

// AccountsGetAccount is the resolver for the accounts_getAccount field.
func (r *queryResolver) AccountsGetAccount(ctx context.Context, accountName string) (*entities.Account, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	return r.domain.GetAccount(uc, accountName)
}

// AccountsResyncAccount is the resolver for the accounts_resyncAccount field.
func (r *queryResolver) AccountsResyncAccount(ctx context.Context, accountName string) (bool, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return false, err
	}

	if err := r.domain.ResyncAccount(uc, accountName); err != nil {
		return false, err
	}
	return true, nil
}

// AccountsListInvitations is the resolver for the accounts_listInvitations field.
func (r *queryResolver) AccountsListInvitations(ctx context.Context, accountName string) ([]*entities.Invitation, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	invs, err := r.domain.ListInvitations(uc, accountName)
	if err != nil {
		return nil, err
	}

	if invs == nil {
		return []*entities.Invitation{}, nil
	}
	return invs, nil
}

// AccountsGetInvitation is the resolver for the accounts_getInvitation field.
func (r *queryResolver) AccountsGetInvitation(ctx context.Context, accountName string, invitationID string) (*entities.Invitation, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.GetInvitation(uc, accountName, repos.ID(invitationID))
}

// AccountsCheckNameAvailability is the resolver for the accounts_checkNameAvailability field.
func (r *queryResolver) AccountsCheckNameAvailability(ctx context.Context, name string) (*domain.CheckNameAvailabilityOutput, error) {
	return r.domain.CheckNameAvailability(ctx, name)
}

// AccountsListMembershipsForUser is the resolver for the accounts_listMembershipsForUser field.
func (r *queryResolver) AccountsListMembershipsForUser(ctx context.Context) ([]*entities.AccountMembership, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.ListMembershipsForUser(uc)
}

// AccountsListMembershipsForAccount is the resolver for the accounts_listMembershipsForAccount field.
func (r *queryResolver) AccountsListMembershipsForAccount(ctx context.Context, accountName string) ([]*entities.AccountMembership, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	return r.domain.ListMembershipsForAccount(uc, accountName)
}

// AccountsGetAccountMembership is the resolver for the accounts_getAccountMembership field.
func (r *queryResolver) AccountsGetAccountMembership(ctx context.Context, accountName string) (*entities.AccountMembership, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	return r.domain.GetAccountMembership(uc, accountName)
}

// AccountMemberships is the resolver for the accountMemberships field.
func (r *userResolver) AccountMemberships(ctx context.Context, obj *model.User) ([]*entities.AccountMembership, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}
	return r.domain.ListMembershipsForUser(uc)
}

// AccountMembership is the resolver for the accountMembership field.
func (r *userResolver) AccountMembership(ctx context.Context, obj *model.User, accountName string) (*entities.AccountMembership, error) {
	uc, err := toUserContext(ctx)
	if err != nil {
		return nil, err
	}

	return r.domain.GetAccountMembership(uc, accountName)
}

// Mutation returns generated.MutationResolver implementation.
func (r *Resolver) Mutation() generated.MutationResolver { return &mutationResolver{r} }

// Query returns generated.QueryResolver implementation.
func (r *Resolver) Query() generated.QueryResolver { return &queryResolver{r} }

// User returns generated.UserResolver implementation.
func (r *Resolver) User() generated.UserResolver { return &userResolver{r} }

type mutationResolver struct{ *Resolver }
type queryResolver struct{ *Resolver }
type userResolver struct{ *Resolver }
