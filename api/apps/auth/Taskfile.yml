version: '3'

tasks:
  run:
    env:
      MONGO_URI: mongodb://mongodb-dev.hotspot.svc.cluster.local:27017
      MONGO_DB_NAME: auth
      REDIS_HOSTS: redis-headless.hotspot.svc.cluster.local:6379
      PORT: 4001
      ORIGINS: http://localhost:4001,https://studio.apollographql.com
      COOKIE_DOMAIN: localhost
#      COOKIE_DOMAIN: .dev.madhouselabs.io
    cmds:
      - go run main.go
  gql:
    sources:
      - graph/schema.graphqls
      - gqlgen.yml
    dir: internal/app
    cmds:
      - go run github.com/99designs/gqlgen generate
