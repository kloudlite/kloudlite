apiVersion: crds.kloudlite.io/v1
kind: App
metadata:
  name: webhooks
  namespace: kl-core
  annotations:
    kloudlite.io/account-ref: kl-core
  labels:
    kloudlite.io/app.name: webhooks
spec:
  services:
    - port: 80
      targetPort: 3000
      type: tcp
  containers:
    - name: main
      image: harbor.dev.madhouselabs.io/kloudlite/webhooks:dev
      env:
        - key: CI_ADDR
          value: "ci-api.kl-core.svc.cluster.local:80"
        - key: HTTP_PORT
          value: "3000"
        - key: KAFKA_BROKERS
          value: redpanda.kl-init-redpanda.svc.cluster.local
        - key: GIT_WEBHOOKS_TOPIC
          value: kl-git-webhooks
      resourceCpu:
        min: "100m"
        max: "200m"
      resourceMemory:
        min: "100Mi"
        max: "200Mi"
