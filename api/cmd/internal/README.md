# Kloudlite CLI

### Authentication

Use the following command to login to kloudlite and logout. when you use `kl login` a browser will be open
and just put your credentials and you will be returned to authenticated session on your terminal.

In case of logout your terminal auth session will be terminated.

```sh
kl login
kl logout
kl connect
kl disconnect
```

### Selecting your account to work with

By simply using the command `kl account list` you can see all the accounts accessible to you and by
using the command `kl account use <account_id>` your current working account will be set according to
your provider account id.

> In case you don't know your account_id then you just use the command `kl account list` 
and choose your account.


```sh
kl account list
kl account use <account_id>
```


### Selecting your project to work with

By simply using the command `kl project list` you can see all the projects accessible to you and by
using the command `kl project use <account_id>` your current working project will be set according to
your provider project id.

> In case of you don't know your project_id then you just use the command `kl project list` 
 and choose your project.


```sh
kl project list
kl project use <project_id>
```

### Working with environments
We support multiple environments to work with. these commands will help you to use and list and create new
environments.

> `kl env create-from` It's on our roadmap and the documentation will be updated soon. 

> `kl env list` can be used to already created environments and by selecting the one you will be set up with 
that environment.

> `kl env use <env_name>` If you know the name of the env then directly providing it can be deleted.  

> `kl env destroy <env_name>` you can also destroy the env in this way. by just providing the env name.

```sh
kl env:create-from <env_from> <new_env_name>
kl env:list
kl env:use <unique_env_name>
kl env:destroy <unique_env_name>
```

### Working with app

When working with apps, you can use the following commands to create, list, and intercept the app.


```
kl app:create
kl app:list
```

### Intercepting an app
You can intercept a running app in this way.

```
kl intercept <appp_id>
```


### Setting your workspace
To setup your workspace first run `kl init`. It will generate a config file and then you can modify 
according to your requirement to that app.

To load environment variables of the app just use the command `kl load`.

```
kl init <filename_optional>

kl add secret <name>
kl add mres <name>
kl add config <name>

kl load

```

### KL Config File structure
This is the structure of app config file which will be generated by executing the command `kl load` and 
you can also modify this file according to your requirement.
```yaml
version: v1
name: <name>
mres:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refKey>

configs:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refkey>
secrets:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refkey>
env:
- key: <key>
  value: <valu>
ports:
- 8000:8000

```

> This CLI is under development so, more information will will be updated in this doc. also if some new commands will be added to the cli will be updated to this doc.

## v2
kl init
    - --projectId={projectId}
    - --accountId={accountId}

kl list 
  - accounts
  - projects [accountId]
  - devices [accountId]
  - configs [projectId]
  - secrets [projectId]
  - apps [projectId]
  - lmbadas [projectId] 
   <!-- - routers {query} -->

kl auth
  - login
    - --from-cookie
  - logout

kl intercept {device}
  - app [id] [name]
      - --projectId={projectId}
      - --accountId={accountId}
  - lambda [id]
      - --projectId={projectId}
      - --accountId={accountId}

kl intercept  --device-id/--device-name=val --app-id/--app-redable-id

kl leave intercept --device-id/--device-name=val --app-id/--app-redable-id

kl {add,delete} 
  - config [name] --map key1=var1 
  - secret [name] --map key1=var1
  - mres [name] --key {key}

kl gen {file}
  --config={configId} 
  --secret={secretId}

kl get
  - config {name} --file={file} --format={format} --items
  - secret {name} --file={file} --format={format} --items
  - app {app}
