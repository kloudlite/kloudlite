# Kloudlite CLI

### Authentication

Use the following command to login to kloudlite and logout. when you use `kl auth login` a browser will be open
and just put your credentials and you will be returned to authenticated session on your terminal.

In case of logout your terminal auth session will be terminated.

```sh
kl auth login
kl auth logout
```

### Selecting your account to work with

By simply using the command `kl list account` you can see all the accounts accessible to you and by
using the command `kl use account <account_id>` your current working account will be set according to
your provided account id.

> In case you don't know your account_id then you just use the command `kl use account` 
and choose your account.


```sh
kl list account
kl use account
kl use account <account_id>
```


### Selecting your project to work with

By simply using the command `kl list project` you can see all the projects accessible to you and by
using the command `kl use project <project_id>` your current working project will be set according to
your provided project id.

> In case of you don't know your project_id then you just use the command `kl use project` 
 and choose your project.


```sh
kl list project
kl use project
kl use project <project_id>
```

### Working with environments
We support multiple environments to work with. these commands 
will help you to use and create new environments.

```sh
kl add config
kl add secret
kl add mres
```

### Working with configs/secrets mounting
You mount configs into a file

```sh
kl gen <filename>
```

### Working with app

When working with apps, you can use the following commands list, and intercept the app.

```
kl list app
kl intercept
kl intercept
kl leave intercept
```

### Intercepting an app
You can intercept a running app in this way.

```
kl intercept <appp_id>
```


### Setting your workspace
To setup your workspace first run `kl init`. It will generate a config file and then you can modify 
according to your requirement to that app.

To load environment variables of the app just use the command `kl load`.

```
kl init <filename_optional>

kl add secret <name>
kl add mres <name>
kl add config <name>

kl load

```

### KL Config File structure
This is the structure of app config file which will be generated by executing the command `kl load` and 
you can also modify this file according to your requirement.
```yaml
version: v1
name: <name>
mres:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refKey>

configs:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refkey>
secrets:
- id: <id>
  name: name
  env:
    - key: <key>
      refKey: <refkey>
env:
- key: <key>
  value: <valu>
ports:
- 8000:8000

```

> This CLI is under development so, more information will will be updated in this doc. also if some new commands will be added to the cli will be updated to this doc.

## v2
kl init
    - --projectId={projectId}
    - --accountId={accountId}

kl list 
  - accounts
  - projects [accountId]
  - devices [accountId]
  - configs [projectId]
  - secrets [projectId]
  - apps [projectId]
  - lmbadas [projectId] 
   <!-- - routers {query} -->

kl auth
  - login
    - --from-cookie
  - logout

kl intercept {device}
  - app [id] [name]
      - --projectId={projectId}
      - --accountId={accountId}
  - lambda [id]
      - --projectId={projectId}
      - --accountId={accountId}

kl intercept  --device-id/--device-name=val --app-id/--app-redable-id

kl leave intercept --device-id/--device-name=val --app-id/--app-redable-id

kl {add,delete} 
  - config [name] --map key1=var1 
  - secret [name] --map key1=var1
  - mres [name] --key {key}

kl gen {file}
  --config={configId} 
  --secret={secretId}

kl get
  - config {name} --file={file} --format={format} --items
  - secret {name} --file={file} --format={format} --items
  - app {app}
