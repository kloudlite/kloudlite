name: Build Helm Worker

on:
  push:
    paths:
      - "operators/helm-charts/Containerfile.helm-job-runner"

permissions:
  contents: read
  packages: write

jobs:
  helm-worker-build:
    runs-on: ubuntu-latest
    name: Build and push helm worker
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Build Helm Job Runner
        run: |
          cd operators/helm-charts
          docker buildx build -f ./Containerfile.helm-job-runner -t ghcr.io/kloudlite/operator-workers/helm-runner . --push