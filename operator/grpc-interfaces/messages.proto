syntax = "proto3";
option go_package = "grpc/messages";

service MessageDispatchService {
  rpc SendActions (StreamActionsRequest) returns (stream Action) {}
  rpc ReceiveErrors(stream ErrorData) returns (Empty) {}
  rpc ReceiveResourceUpdates (stream ResourceUpdate) returns (Empty) {}
  rpc ReceiveInfraUpdates (stream InfraUpdate) returns (Empty) {}
  rpc ReceiveBYOCClientUpdates (stream BYOCClientUpdate) returns (Empty) {}
  rpc GetAccessToken(GetClusterTokenIn) returns (GetClusterTokenOut) {}
}

message StreamActionsRequest {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
}

message GetClusterTokenIn {
  string clusterToken = 1;
}

message GetClusterTokenOut {
  string accessToken = 1;
  string harborDockerConfigJson = 2;
}

message Action {
  bytes data = 1;
}

message ErrorData {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes data = 4;
}

message ResourceUpdate {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes message = 4;
}

message InfraUpdate {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes message = 4;
}

message BYOCClientUpdate {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes message = 4;
}

message Empty {}
