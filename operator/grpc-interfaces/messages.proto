syntax = "proto3";
option go_package = "grpc/messages";

service MessageDispatchService {
  rpc SendActions (StreamActionsRequest) returns (stream Action) {}
  rpc ReceiveErrors(stream ErrorData) returns (Empty) {}
  rpc ReceiveStatusMessages (stream StatusData) returns (Empty) {}
  rpc ReceiveInfraUpdates (stream InfraStatusData) returns (Empty) {}
  rpc GetAccessToken(GetClusterTokenIn) returns (GetClusterTokenOut) {}
}

message StreamActionsRequest {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
}

message GetClusterTokenIn {
  string clusterToken = 1;
}

message GetClusterTokenOut {
  string accessToken = 1;
}

message Action {
  bytes data = 1;
}

message ErrorData {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes data = 4;
}

message StatusData {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes statusUpdateMessage = 4;
}

message InfraStatusData {
  string accessToken = 1;
  string clusterName = 2;
  string accountName = 3;
  bytes infraUpdateMessage = 4;
}

message Empty {}
