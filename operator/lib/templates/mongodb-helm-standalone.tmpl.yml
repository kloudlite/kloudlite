apiVersion: msvc.kloudlite.io/v1
kind: HelmMongoDB
metadata:
  name: {{.Name}}
  namespace: {{.Namespace}}
  ownerReferences:
    - apiVersion: {{.APIVersion}}
      kind: {{.Kind}}
      name: {{.Name}}
      uid: {{.UID}}
      controller: true
      blockOwnerDeletion: true
spec:
#  global:
#    storageClass: do-block-storage
  image:
    tag: 5.0.8-debian-10-r20
  auth:
    enabled: true
    rootPassword: {{ index (mustFromJson (.Spec.Inputs | toJson)) "root_password" }}
  persistence:
    enabled: true
    size: {{ index (mustFromJson (.Spec.Inputs | toJson )) "size" | default "1Gi" }}
  volumePermissions:
    enabled: true
  metrics:
    enabled: false

  resources:
    requests:
      cpu: {{ index (mustFromJson (.Spec.Inputs | toJson)) "cpu_min" | default 400 }}m
      memory: {{ index (mustFromJson (.Spec.Inputs | toJson)) "memory_min" | default 400 }}Mi
    limits:
      cpu: {{ index (mustFromJson (.Spec.Inputs | toJson)) "cpu_max" |  default 400}}m
      memory: {{ index (mustFromJson (.Spec.Inputs | toJson)) "memory_max" | default 500}}Mi
