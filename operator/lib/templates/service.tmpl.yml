apiVersion: v1
kind: Service
metadata:
  namespace: {{.Namespace}}
  name: {{.Name}}
  ownerReferences:
    - apiVersion: {{.APIVersion}}
      kind: {{.Kind}}
      name: {{.Name}}
      uid: {{.UID}}
      controller: true
      blockOwnerDeletion: true
spec:
  selector:
    app: {{.Name}}
  ports:
    {{- range .Spec.Services }}
    {{- with . }}
    - protocol: {{.Type | upper | default "TCP"}}
      port: {{.Port}}
      targetPort: {{.TargetPort}}
    {{- end }}
    {{- end }}
