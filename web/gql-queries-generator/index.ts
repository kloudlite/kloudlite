import { GQLServerHandler as consoleHandler } from '~/console/server/gql/saved-queries';
// import { GQLServerHandler as iotconsoleHandler } from '~/iotconsole/server/gql/saved-queries';
import fs from 'fs';
import { GQLServerHandler as authHandler } from '~/auth/server/gql/saved-queries';
import { GQLServerHandler as libHandler } from '../lib/server/gql/saved-queries';
import { docPath, ensureDirectoryExistence, loader } from './loader';

const init = () => {
  ensureDirectoryExistence(docPath);
  const results = [
    loader(consoleHandler, 'console'),
    // loader(iotconsoleHandler, 'iotconsole'),
    loader(authHandler, 'auth'),
    loader(libHandler, 'lib'),
  ];

  const info = `# This file is auto generated don't modify it manually
# generated by pnpm gql:parse
`;

  fs.writeFileSync(
    `${docPath}/queries.graphql`,
    `${info}\n${results.join('\n\n')}`
  );
};

init();
